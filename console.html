<html>

<head>
	<meta charset="utf-8" />
	<title>console</title>
</head>
<body>
<h1>console</h1>
<div id="result">

</div>
<textarea id="command" name="command">

</textarea>
<input type="button" id="btn_exec" value="执行代码">
<script type="text/javascript">
window.onload = function() {
	var host = '127.0.0.1';  
	var port = 8888;  
	var url = 'ws://'+host+':'+port+'/';

	var ws = new WebSocket(url, 'echo-protocol');

	ws.onopen = function() {  //通过onopen事件句柄来监听socket的打开事件
		ws.send("console");
	} 
	ws.onmessage = function(result) {
		$("result").innerHTML = $("result").innerHTML + result.data + '<br/>'; 
		console.log(result.data)
	}

	ws.onclose = function(evt) {
		$("result").innerHTML = $("result").innerHTML + "连接已断开" + '<br/>'; 
	}

	$("btn_exec").addEventListener("click",function(event){
		var command = $("command").value;
		ws.send("command#" + command.trim());
	});


	function $(id) {  
		return document.getElementById(id);  
	}
}
</script>

</body>
</html>