<html>
<head>
<meta charset="utf-8" />
<script type="text/javascript">
var _W = undefined;
//错误处理
window.onerror = function(errorMessage, scriptURI, lineNumber, columnNumber, error) {

	    reportError({
	      message: errorMessage,
	      script: scriptURI,
	      line: lineNumber,
	      column: columnNumber
	    });

	return true;
}

function reportError(error) {
	// console.log(error);
	var errorStr = "错误信息：" + error.message + "，文件：" + error.script + " 第" + error.line +"行，" + error.column + "列";
	// return errorStr;
	console.log(errorStr);
	// _W.send(errorStr); 
	// send();
}

</script>
<script type="text/javascript">  
var host = '127.0.0.1';  
var port = 8888;  
var url = 'ws://'+host+':'+port+'/';  
var w = new WebSocket(url);  //构建于服务器之间的连接通信
_W = w;
<!--var audioElement = document.createElement('audio');  -->

<!--audioElement.setAttribute('src', 'qqmsg.mp3');-->  
w.onopen = function()//通过onopen事件句柄来监听socket的打开事件
{  
	$('chat-box').innerHTML = '已连接到服务器......<br/>';  
}  
w.onmessage = function(e)//用onmessage事件句柄接受服务器传过来的数据
{  
   var msg = e.data;  
   var chatBox = $('chat-box');  
  // audioElement.play();      
   chatBox.innerHTML = chatBox.innerHTML+msg+'<br/>';  
}  
    
 function send()//使用send方法向服务器发送数据
 {  
     var talk = $('talk');  
     var nike = $('nike');   
     w.send('<strong style="color:red">'+nike.value+':</strong>'+talk.value);  
 }  
 function $(id)
 {  
     return document.getElementById(id);  
 }

 vonsoel.log();
 </script>
</head>
<body>
<div id="chat-box" style="border:1px solid #cccccc; width:400px; height:400px; overflow:scroll;"></div>
昵称:
<input type="text" id="nike"/>
<br/>
内容:
<input type="text" id="talk"/>
<input type="button" id="send" onClick="send();" value="发送"/>

</body>
</html>
